import{X as o,k as c,S as g,r as s,o as C,h as I,w as a,f as u,d as l,t as S,fA as D}from"./index-CeUf7hzR.js";const f={getPageList(e={}){return o({url:"setting/crontab/index",method:"get",params:e})},getLogPageList(e={}){return o({url:"setting/crontab/logPageList",method:"get",params:e})},deleteLog(e){return o({url:"setting/crontab/deleteCrontabLog",method:"delete",data:e})},run(e={}){return o({url:"setting/crontab/run",method:"post",data:e})},save(e={}){return o({url:"setting/crontab/save",method:"post",data:e})},deletes(e){return o({url:"setting/crontab/delete",method:"delete",data:e})},update(e,i={}){return o({url:"setting/crontab/update/"+e,method:"put",data:i})},changeStatus(e={}){return o({url:"setting/crontab/changeStatus",method:"put",data:e})}},P={__name:"logList",setup(e,{expose:i}){const p=c(),_=c(),d=c(!1),m=t=>{_.value=t,p.value.requestData(),d.value=!0},h=t=>{const r=t.exception_info;D.info({simple:!1,title:"异常信息",content:r==""?"无异常信息":r})},b=g({autoRequest:!1,api:f.getLogPageList,showIndex:!1,rowSelection:{showCheckedAll:!0},operationColumn:!0,operationColumnWidth:100,delete:{show:!0,api:f.deleteLog,auth:["setting:crontab:deleteCrontabLog"]},beforeRequest:t=>{t.orderBy="created_at",t.orderType="desc",t.crontab_id=_.value}}),x=g([{title:"ID",dataIndex:"id",addDisplay:!1,editDisplay:!1,width:50,hide:!0},{title:"执行时间",dataIndex:"created_at",width:180},{title:"执行目标",dataIndex:"target",width:240},{title:"执行结果",dataIndex:"status",width:100},{title:"异常信息",dataIndex:"exception_info",width:100}]);return i({open:m}),(t,r)=>{const v=s("a-tag"),w=s("icon-eye"),L=s("a-link"),k=s("ma-crud"),y=s("a-drawer");return C(),I(y,{footer:!1,visible:d.value,"onUpdate:visible":r[0]||(r[0]=n=>d.value=n),width:"800px"},{title:a(()=>[u("执行日志")]),default:a(()=>[l(k,{options:b,columns:x,ref_key:"crudRef",ref:p},{status:a(({record:n})=>[l(v,{color:`${n.status==1?"green":"red"}`},{default:a(()=>[u(S(n.status==1?"成功":"失败"),1)]),_:2},1032,["color"])]),exception_info:a(({record:n})=>[l(L,{onClick:q=>h(n)},{default:a(()=>[l(w),u(" 查看")]),_:2},1032,["onClick"])]),_:1},8,["options","columns"])]),_:1},8,["visible"])}}},B=Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"}));export{P as _,f as c,B as l};
