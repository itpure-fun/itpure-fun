import{m as s}from"./menu-C2llVahg.js";import{_ as T,k as f,a7 as A,S as h,r as i,fy as R,o as p,c as B,d as c,w as o,h as y,K as L,i as _,e as M,N as S,f as N,M as v}from"./index-CeUf7hzR.js";const E={class:"ma-content-block lg:flex justify-between p-4"},O={name:"system:menu"},j=Object.assign(O,{setup(q){const l=f();f();let w=A(()=>l.value?l.value.isRecovery:!1);const x=[{label:"菜单",value:"M"},{label:"按钮",value:"B"},{label:"外链",value:"L"},{label:"iFrame",value:"I"}],g=async(e,d)=>{const t=await s.changeStatus({id:d,status:e});t.success&&v.success(t.message)},k=e=>{m[1].addDefaultValue=e,l.value.crudFormRef.add()},b=async(e,d)=>{const t=await s.numberOperation({id:d,numberName:"sort",numberValue:e});t.success&&v.success(t.message)},I=h({api:s.getList,recycleApi:s.getRecycleList,showIndex:!1,pageLayout:"fixed",rowSelection:{showCheckedAll:!0},operationColumn:!0,operationColumnWidth:200,add:{show:!0,api:s.save,auth:["system:menu:save"]},edit:{show:!0,api:s.update,auth:["system:menu:update"]},delete:{show:!0,api:s.deletes,auth:["system:menu:delete"],realApi:s.realDeletes,realAuth:["system:menu:realDeletes"]},recovery:{show:!0,api:s.recoverys,auth:["system:menu:recovery"]},formOption:{viewType:"drawer",width:600},isExpand:!0,beforeOpenAdd:()=>(m[1].addDefaultValue=0,!0),beforeEdit:e=>(delete e.children,!0)}),m=h([{title:"ID",dataIndex:"id",addDisplay:!1,editDisplay:!1,width:50,hide:!0},{title:"上级菜单",dataIndex:"parent_id",hide:!0,formType:"tree-select",dict:{url:"system/menu/tree",params:{onlyMenu:!0}},addDefaultValue:0,editDefaultValue:e=>e.parent_id==0?void 0:e.parent_id},{title:"菜单名称",dataIndex:"name",search:!0,commonRules:[{required:!0,message:"菜单名称必填"}],width:180},{title:"菜单类型",dataIndex:"type",formType:"radio",addDefaultValue:"M",width:100,dict:{data:x,translation:!0,tagColors:{M:"blue",B:"green",L:"orangered",I:"pinkpurple"}},onControl:(e,d)=>{const t=d.getColumnService(),r=["icon","route","component","redirect","sort","is_hidden","restful"];if(e==="B"){r.map(n=>t.get(n).setAttr("display",!1));return}if(["I","L"].includes(e)){r.map(n=>t.get(n).setAttr("display",["icon","route","sort","is_hidden"].includes(n)));return}r.map(n=>t.get(n).setAttr("display",!0))}},{title:"图标",dataIndex:"icon",width:80,formType:"icon-picker",style:{width:"100%"}},{title:"菜单标识",dataIndex:"code",search:!0,commonRules:[{required:!0,message:"菜单标识必填"}],width:150},{title:"路由地址",dataIndex:"route",width:150},{title:"视图组件",dataIndex:"component",width:200},{title:"重定向",dataIndex:"redirect",hide:!0},{title:"排序",dataIndex:"sort",formType:"input-number",addDefaultValue:1,width:180,min:0,max:1e3},{title:"隐藏",dataIndex:"is_hidden",search:!0,formType:"radio",dict:{data:[{label:"是",value:"1"},{label:"否",value:"2"}],translation:!0},addDefaultValue:"2",editDefaultValue:e=>e.is_hidden.toString(),width:80},{title:"状态",dataIndex:"status",search:!0,formType:"radio",dict:{name:"data_status",props:{label:"title",value:"key"}},addDefaultValue:"1",width:120},{title:"生成按钮",dataIndex:"restful",hide:!0,formType:"radio",dict:{data:[{title:"是",key:"1"},{title:"否",key:"2"}],props:{label:"title",value:"key"}},addDefaultValue:"2",editDisplay:!1},{title:"备注",dataIndex:"remark",hide:!0,formType:"textarea"},{title:"创建时间",dataIndex:"created_at",addDisplay:!1,editDisplay:!1,search:!0,formType:"range",width:180}]);return(e,d)=>{const t=i("a-input-number"),r=i("a-switch"),n=i("icon-plus"),D=i("a-link"),C=i("ma-crud"),V=R("auth");return p(),B("div",E,[c(C,{options:I,columns:m,ref_key:"crudRef",ref:l},{sort:o(({record:a})=>[c(t,{"default-value":a.sort,mode:"button",onChange:u=>b(u,a.id),min:0,max:1e3},null,8,["default-value","onChange"])]),icon:o(({record:a})=>[a.icon?(p(),y(L(a.icon),{key:0})):_("",!0)]),status:o(({record:a})=>[c(r,{"checked-value":1,"unchecked-value":"2",onChange:u=>g(u,a.id),"default-checked":a.status==1},null,8,["onChange","default-checked"])]),operationBeforeExtend:o(({record:a})=>[a.type==="M"&&!M(w)?S((p(),y(D,{key:0,onClick:u=>k(a.id)},{default:o(()=>[c(n),N(" 新增")]),_:2},1032,["onClick"])),[[V,["system:menu:save"]]]):_("",!0)]),_:1},8,["options","columns"])])}}}),W=T(j,[["__scopeId","data-v-ba66c7ae"]]);export{W as default};
