import{_ as ge,k as y,r as s,o as c,h as q,w as a,f as d,t as v,d as e,c as h,F as I,g as T,l as p,i as B,N as he,O as Ue,M as z,q as ke,H as qe,I as Ie}from"./index-CeUf7hzR.js";import{g as O}from"./generate-Cwn7oav1.js";import{d as Te}from"./dataMaintain-CuQfJgm8.js";import{m as Ce}from"./menu-C2llVahg.js";import{r as De}from"./role-VtW8cE0Z.js";import{d as Se}from"./dict-D0jfdQ0W.js";import Me from"./settingComponent-B-w2-Md2.js";const Ne=[{name:"新增",value:"save",comment:"勾选生成新增数据按钮菜单及接口"},{name:"更新",value:"update",comment:"勾选生成更新数据按钮菜单及接口"},{name:"读取",value:"read",comment:"勾选生成读取数据按钮菜单及接口"},{name:"删除",value:"delete",comment:"勾选生成真实删除按钮菜单及接口"},{name:"回收站列表",value:"recycle",comment:"勾选生成移到回收站列表、真实删除、恢复菜单及接口，确定该表有deleted_at字段，且模型引入了软删除。"},{name:"修改状态",value:"changeStatus",comment:"勾选生成修改状态按钮菜单及接口，该接口用于单个字段状态修改"},{name:"自增自减",value:"numberOperation",comment:"勾选生成数据自增自减按钮菜单及接口，该接口用于单个字段增减操作"},{name:"导入",value:"import",comment:"勾选生成导入按钮菜单、接口和DTO文件"},{name:"导出",value:"export",comment:"勾选生成导出按钮菜单、接口和DTO文件"}],Ke=[{name:"一对一",value:"hasOne"},{name:"一对多",value:"hasMany"},{name:"一对多（反向)",value:"belongsTo"},{name:"多对多",value:"belongsToMany"}],Oe=[{label:"=",value:"eq"},{label:"!=",value:"neq"},{label:">",value:"gt"},{label:">=",value:"gte"},{label:"<",value:"lt"},{label:"<=",value:"lte"},{label:"LIKE",value:"like"},{label:"IN",value:"in"},{label:"NOT IN",value:"notin"},{label:"BETWEEN",value:"between"}],Ee=[{label:"输入框",value:"text"},{label:"密码框",value:"password"},{label:"文本域",value:"textarea"},{label:"数字输入框",value:"inputNumber"},{label:"标签输入框",value:"inputTag"},{label:"提及",value:"mention"},{label:"开关",value:"switch"},{label:"滑块",value:"slider"},{label:"下拉框",value:"select"},{label:"树形下拉框",value:"treeSelect"},{label:"单选框",value:"radio"},{label:"复选框",value:"checkbox"},{label:"日期选择器",value:"date"},{label:"时间选择器",value:"time"},{label:"评分器",value:"rate"},{label:"级联选择器",value:"cascader"},{label:"数据穿梭框",value:"transfer"},{label:"用户选择器",value:"selectUser"},{label:"用户信息",value:"userInfo"},{label:"省市区联动",value:"cityLinkage"},{label:"子表单",value:"formGroup"},{label:"上传组件",value:"upload"},{label:"资源选择器",value:"selectResource"},{label:"富文本控件",value:"editor"},{label:"wangEditor富文本",value:"wangEditor"},{label:"代码编辑器",value:"codeEditor"}],Le=N=>(qe("data-v-c4036efc"),N=N(),Ie(),N),je={class:"flex justify-between w-full"},Re={key:0},Be={class:"flex justify-between w-full"},ze={class:"flex justify-between w-full"},Ae={class:"flex justify-between w-full"},Fe={key:1},Ge={class:"flex justify-between w-full"},Pe=Le(()=>p("p",null,"数据字典在页面控件为下拉框、单选框、复选框和数据穿梭框才可选择",-1)),$e={class:"flex justify-between w-full"},He={class:"flex justify-between w-full"},Qe={name:"setting:code:update"},We=Object.assign(Qe,{emits:["success"],setup(N,{expose:Z,emit:ee}){const V=y({}),A=y(!0),E=y(!1),F=y("base_config"),G=y(),le=y(["text","password","textarea","formGroup","inputTag","mention","rate","userInfo"]),t=y({generate_menus:["save","update","read","delete","recycle","changeStatus","numberOperation","import","export"],columns:[]}),P=y(),ae=ee,f=y({relations:[]}),L=y([]),$=y([]),H=y([]),Q=y([]),W=y([]),J=y([]),te=async U=>{E.value=!0;const o=await O.readTable({id:U});V.value=o.data,se(),A.value=!1},oe=(U,o)=>{t.value.columns.find((x,b)=>{x.column_name==U&&(t.value.columns[b].options=o)}),z.success("组件设置成功")},ue=async U=>{const o=await P.value.validate();if(o){for(let b in o)z.error(o[b].message);return!1}t.value.options=f.value;const x=await O.update(t.value);x.success&&z.success(x.message),ae("success",!0),U(!0)},S=(U,o)=>t.value.columns.map(x=>{x["is_"+o]=U}),ne=()=>{f.value.relations.push({name:"",type:"hasOne",model:"",foreignKey:"",localKey:"",table:""})},de=U=>f.value.relations.splice(U,1),se=()=>{var U,o,x,b,m,i;for(let _ in V.value)_==="generate_menus"?t.value[_]=V.value[_]?V.value[_].split(","):[]:t.value[_]=V.value[_];V.value.options&&V.value.options.relations?f.value.relations=V.value.options.relations:f.value.relations=[],V.value.component_type===3&&(f.value.tag_id=((o=(U=V.value)==null?void 0:U.options)==null?void 0:o.tag_id)??void 0,f.value.tag_name=((b=(x=V.value)==null?void 0:x.options)==null?void 0:b.tag_name)??void 0,f.value.tag_view_name=((i=(m=V.value)==null?void 0:m.options)==null?void 0:i.tag_view_name)??void 0),O.getTableColumns({table_id:V.value.id}).then(_=>{t.value.columns=[],_.data.map(r=>{r.is_required=r.is_required===2,r.is_insert=r.is_insert===2,r.is_edit=r.is_edit===2,r.is_list=r.is_list===2,r.is_query=r.is_query===2,r.is_sort=r.is_sort===2,t.value.columns.push(r)})}),ke.getModuleList().then(_=>J.value=_.data),Ce.tree({onlyMenu:!0}).then(_=>{L.value=_.data,L.value.unshift({id:0,value:0,label:"顶级菜单"})}),De.getList().then(_=>$.value=_.data),O.getModels().then(_=>Q.value=_.data),Te.getPageList({pageSize:999}).then(_=>W.value=_.data.items),Se.getTypeList({pageSize:999}).then(_=>H.value=_.data.items)};return Z({open:te}),(U,o)=>{const x=s("a-divider"),b=s("a-input"),m=s("a-form-item"),i=s("a-col"),_=s("a-textarea"),r=s("a-row"),C=s("a-option"),w=s("a-select"),me=s("a-cascader"),D=s("a-radio"),j=s("a-radio-group"),K=s("a-tab-pane"),X=s("a-tag"),R=s("a-alert"),ie=s("a-input-number"),g=s("a-table-column"),k=s("a-checkbox"),M=s("a-tooltip"),Y=s("a-link"),ce=s("a-space"),re=s("a-table"),_e=s("a-checkbox-group"),pe=s("icon-plus"),fe=s("a-button"),ve=s("icon-delete"),be=s("a-tabs"),xe=s("a-form"),ye=s("a-spin"),Ve=s("a-modal");return c(),q(Ve,{visible:E.value,"onUpdate:visible":o[25]||(o[25]=l=>E.value=l),"on-before-ok":ue,fullscreen:"","unmount-on-close":""},{title:a(()=>{var l;return[d("编辑生成信息 - "+v((l=V.value)==null?void 0:l.table_comment),1)]}),default:a(()=>[e(ye,{loading:A.value,tip:"加载数据中...",class:"w-full"},{default:a(()=>[e(xe,{model:t.value,ref_key:"formRef",ref:P},{default:a(()=>[e(be,{"active-key":F.value,"onUpdate:activeKey":o[24]||(o[24]=l=>F.value=l)},{default:a(()=>[e(K,{title:"配置信息",key:"base_config"},{default:a(()=>[e(x,{orientation:"left"},{default:a(()=>[d("基础信息")]),_:1}),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"表名称",field:"table_name","label-col-flex":"auto","label-col-style":{width:"100px"}},{default:a(()=>[e(b,{modelValue:t.value.table_name,"onUpdate:modelValue":o[0]||(o[0]=l=>t.value.table_name=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"表描述",field:"table_comment","label-col-flex":"auto","label-col-style":{width:"100px"},rules:[{required:!0,message:"表描述必填"}]},{default:a(()=>[e(b,{modelValue:t.value.table_comment,"onUpdate:modelValue":o[1]||(o[1]=l=>t.value.table_comment=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:24,xl:24},{default:a(()=>[e(m,{label:"备注信息",field:"remark","label-col-flex":"auto","label-col-style":{width:"94px"}},{default:a(()=>[e(_,{modelValue:t.value.remark,"onUpdate:modelValue":o[2]||(o[2]=l=>t.value.remark=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,{orientation:"left"},{default:a(()=>[d("生成信息")]),_:1}),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"所属模块",field:"module_name","label-col-flex":"auto","label-col-style":{width:"100px"},rules:[{required:!0,message:"所属模块必选"}],extra:"所属模块请对应表模块前缀，否则会生成失败，且在安装模块时，数据迁移文件会被忽略"},{default:a(()=>[e(w,{style:{width:"100%"},modelValue:t.value.module_name,"onUpdate:modelValue":o[3]||(o[3]=l=>t.value.module_name=l),"allow-clear":"","allow-search":"",placeholder:"请选择所属模块"},{default:a(()=>[(c(!0),h(I,null,T(J.value,(l,u)=>(c(),q(C,{class:"w-full",label:l.name,value:l.name,key:u},{default:a(()=>[p("div",je,[p("span",null,v(l.name),1),p("span",null,v(l.label),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"所属菜单",field:"belong_menu_id","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"分配业务功能在哪个菜单，例如：权限管理。不选择则为顶级菜单"},{default:a(()=>[e(me,{modelValue:t.value.belong_menu_id,"onUpdate:modelValue":o[4]||(o[4]=l=>t.value.belong_menu_id=l),options:L.value,"expand-trigger":"hover",style:{width:"100%"},placeholder:"生成功能所属菜单","allow-search":"","allow-clear":"","check-strictly":""},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"生成类型",field:"type","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"单表须有主键，树表须指定id、parent_id、name等字段"},{default:a(()=>[e(w,{style:{width:"100%"},modelValue:t.value.type,"onUpdate:modelValue":o[5]||(o[5]=l=>t.value.type=l),options:[{label:"单表增删改查",value:"single"},{label:"树表增删改查",value:"tree"}],"allow-clear":"","allow-search":"",placeholder:"请选择所属模块"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"菜单名称",field:"menu_name","label-col-flex":"auto","label-col-style":{width:"100px"},rules:[{required:!0,message:"菜单名称必选"}],extra:"显示在左侧菜单上的名称、以及以及代码中的业务名称"},{default:a(()=>[e(b,{"allow-clear":"",modelValue:t.value.menu_name,"onUpdate:modelValue":o[6]||(o[6]=l=>t.value.menu_name=l),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"包名",field:"package_name","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"指定控制器文件所在控制器目录的二级目录名，如：Premission"},{default:a(()=>[e(b,{"allow-clear":"",modelValue:t.value.package_name,"onUpdate:modelValue":o[7]||(o[7]=l=>t.value.package_name=l),placeholder:"请输入包名"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"生成方式",field:"generate_type","label-col-flex":"auto","label-col-style":{width:"100px"},rules:[{required:!0,message:"菜单名称必选"}],extra:"如选择生成到目录，只会对后端文件进行到目录生成（覆盖形式），前端文件和菜单SQL还以压缩包方式下载"},{default:a(()=>[e(j,{"model-value":t.value.generate_type,"onUpdate:modelValue":o[8]||(o[8]=l=>t.value.generate_type=l),type:"button"},{default:a(()=>[e(D,{value:1},{default:a(()=>[d("压缩包下载")]),_:1}),e(D,{value:2},{default:a(()=>[d("生成到目录")]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"组件样式",field:"component_type","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"设置新增和修改组件显示方式，Tag页表示新打开的一个标签来显示新增和编辑"},{default:a(()=>[e(j,{"model-value":t.value.component_type,"onUpdate:modelValue":o[9]||(o[9]=l=>t.value.component_type=l),type:"button"},{default:a(()=>[e(D,{value:1},{default:a(()=>[d("模态框")]),_:1}),e(D,{value:2},{default:a(()=>[d("抽屉")]),_:1}),e(D,{value:3},{default:a(()=>[d("Tag页")]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1}),e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"构建菜单",field:"build_menu","label-col-flex":"auto","label-col-style":{width:"100px"},rules:[{required:!0,message:"菜单名称必选"}],extra:"如选择构建菜单，在每次生成代码都会进行生成菜单操作。"},{default:a(()=>[e(j,{"model-value":t.value.build_menu,"onUpdate:modelValue":o[10]||(o[10]=l=>t.value.build_menu=l),type:"button"},{default:a(()=>[e(D,{value:1},{default:a(()=>[d("不构建菜单")]),_:1}),e(D,{value:2},{default:a(()=>[d("构建菜单")]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1}),t.value.type==="tree"?(c(),h("div",Re,[e(x,{orientation:"left"},{default:a(()=>[d("树表配置")]),_:1}),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:8,xl:8},{default:a(()=>[e(m,{label:"树主ID",field:"tree_id","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"指定树表的主要ID，一般为主键"},{default:a(()=>[e(w,{style:{width:"100%"},modelValue:f.value.tree_id,"onUpdate:modelValue":o[11]||(o[11]=l=>f.value.tree_id=l),"allow-clear":"","allow-search":"",placeholder:"请选择树表的主ID"},{default:a(()=>[(c(!0),h(I,null,T(t.value.columns,(l,u)=>(c(),q(C,{class:"w-full",label:l.column_name+" - "+l.column_comment,value:l.column_name,key:u},{default:a(()=>[p("div",Be,[p("span",null,v(l.column_name),1),p("span",null,v(l.column_comment),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:8,xl:8},{default:a(()=>[e(m,{label:"树父ID",field:"tree_parent_id","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"指定树表的父ID，比如：parent_id"},{default:a(()=>[e(w,{style:{width:"100%"},modelValue:f.value.tree_parent_id,"onUpdate:modelValue":o[12]||(o[12]=l=>f.value.tree_parent_id=l),"allow-clear":"","allow-search":"",placeholder:"请选择树表的父ID"},{default:a(()=>[(c(!0),h(I,null,T(t.value.columns,(l,u)=>(c(),q(C,{class:"w-full",label:l.column_name+" - "+l.column_comment,value:l.column_name,key:u},{default:a(()=>[p("div",ze,[p("span",null,v(l.column_name),1),p("span",null,v(l.column_comment),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:8,xl:8},{default:a(()=>[e(m,{label:"树名称",field:"tree_name","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"指定树显示的名称字段，比如：name"},{default:a(()=>[e(w,{style:{width:"100%"},modelValue:f.value.tree_name,"onUpdate:modelValue":o[13]||(o[13]=l=>f.value.tree_name=l),"allow-clear":"","allow-search":"",placeholder:"请选择树表的主ID"},{default:a(()=>[(c(!0),h(I,null,T(t.value.columns,(l,u)=>(c(),q(C,{class:"w-full",label:l.column_name+" - "+l.column_comment,value:l.column_name,key:u},{default:a(()=>[p("div",Ae,[p("span",null,v(l.column_name),1),p("span",null,v(l.column_comment),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])):B("",!0),t.value.component_type===3?(c(),h("div",Fe,[e(x,{orientation:"left"},{default:a(()=>[d("Tag页配置")]),_:1}),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:8,xl:8},{default:a(()=>[e(m,{label:"标签页ID",field:"tag_id","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"指定标签页的ID，要保证全局唯一性"},{default:a(()=>[e(b,{modelValue:f.value.tag_id,"onUpdate:modelValue":o[14]||(o[14]=l=>f.value.tag_id=l),placeholder:"请输入标签页ID"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:8,xl:8},{default:a(()=>[e(m,{label:"标签页名称",field:"tag_name","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"指定标签的显示内容，注意：在打开标签后，会在标签前面加上新增或编辑"},{default:a(()=>[e(b,{modelValue:f.value.tag_name,"onUpdate:modelValue":o[15]||(o[15]=l=>f.value.tag_name=l),placeholder:"请输入标签页名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,md:8,xl:8},{default:a(()=>[e(m,{label:"标签显示字段",field:"tag_view_name","label-col-flex":"auto","label-col-style":{width:"120px"},extra:"在标签后面显示某个字段的值，一般指定 title 或者 name 等字段"},{default:a(()=>[e(w,{style:{width:"100%"},modelValue:f.value.tag_view_name,"onUpdate:modelValue":o[16]||(o[16]=l=>f.value.tag_view_name=l),"allow-clear":"","allow-search":"",placeholder:"请选择标签显示字段"},{default:a(()=>[(c(!0),h(I,null,T(t.value.columns,(l,u)=>(c(),q(C,{class:"w-full",label:l.column_name+" - "+l.column_comment,value:l.column_name,key:u},{default:a(()=>[p("div",Ge,[p("span",null,v(l.column_name),1),p("span",null,v(l.column_comment),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})])):B("",!0)]),_:1}),e(K,{title:"字段配置",key:"field_config"},{default:a(()=>[e(R,{title:"提示"},{default:a(()=>[d(" 使用数组形式字段的组件，请在模型的 "),e(X,{color:"#168cff"},{default:a(()=>[d("casts")]),_:1}),d(" 设置相应字段为 "),e(X,{color:"#168cff"},{default:a(()=>[d("array")]),_:1}),d(" 类型 "),Pe]),_:1}),e(re,{data:t.value.columns,pagination:!1,class:"mt-3"},{columns:a(()=>[e(g,{dataIndex:"sort",title:"排序",width:100},{cell:a(({rowIndex:l})=>[e(ie,{modelValue:t.value.columns[l].sort,"onUpdate:modelValue":u=>t.value.columns[l].sort=u},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{dataIndex:"column_name",title:"字段名称",width:150,tooltip:""}),e(g,{dataIndex:"column_comment",title:"字段描述",width:180},{cell:a(({rowIndex:l})=>[e(b,{modelValue:t.value.columns[l].column_comment,"onUpdate:modelValue":u=>t.value.columns[l].column_comment=u,"allow-clear":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{dataIndex:"column_type",title:"物理类型",width:120}),e(g,{dataIndex:"is_required",title:"必填",width:80},{title:a(()=>[d("必填 "),e(M,{content:"全选 / 全不选",position:"bottom"},{default:a(()=>[e(k,{onChange:o[17]||(o[17]=l=>S(l,"required"))})]),_:1})]),cell:a(({rowIndex:l})=>[e(k,{modelValue:t.value.columns[l].is_required,"onUpdate:modelValue":u=>t.value.columns[l].is_required=u},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{dataIndex:"is_insert",title:"插入",width:80},{title:a(()=>[d("插入 "),e(M,{content:"全选 / 全不选",position:"bottom"},{default:a(()=>[e(k,{onChange:o[18]||(o[18]=l=>S(l,"insert"))})]),_:1})]),cell:a(({rowIndex:l})=>[e(k,{modelValue:t.value.columns[l].is_insert,"onUpdate:modelValue":u=>t.value.columns[l].is_insert=u},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{dataIndex:"is_edit",title:"编辑",width:80},{title:a(()=>[d("编辑 "),e(M,{content:"全选 / 全不选",position:"bottom"},{default:a(()=>[e(k,{onChange:o[19]||(o[19]=l=>S(l,"edit"))})]),_:1})]),cell:a(({rowIndex:l})=>[e(k,{modelValue:t.value.columns[l].is_edit,"onUpdate:modelValue":u=>t.value.columns[l].is_edit=u},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{dataIndex:"is_list",title:"列表",width:80},{title:a(()=>[d("列表 "),e(M,{content:"全选 / 全不选",position:"bottom"},{default:a(()=>[e(k,{onChange:o[20]||(o[20]=l=>S(l,"list"))})]),_:1})]),cell:a(({rowIndex:l})=>[e(k,{modelValue:t.value.columns[l].is_list,"onUpdate:modelValue":u=>t.value.columns[l].is_list=u},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{dataIndex:"is_query",title:"查询",width:80},{title:a(()=>[d("查询 "),e(M,{content:"全选 / 全不选",position:"bottom"},{default:a(()=>[e(k,{onChange:o[21]||(o[21]=l=>S(l,"query"))})]),_:1})]),cell:a(({rowIndex:l})=>[e(k,{modelValue:t.value.columns[l].is_query,"onUpdate:modelValue":u=>t.value.columns[l].is_query=u},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{dataIndex:"is_sort",title:"排序",width:80},{title:a(()=>[d("排序 "),e(M,{content:"全选 / 全不选",position:"bottom"},{default:a(()=>[e(k,{onChange:o[22]||(o[22]=l=>S(l,"sort"))})]),_:1})]),cell:a(({rowIndex:l})=>[e(k,{modelValue:t.value.columns[l].is_sort,"onUpdate:modelValue":u=>t.value.columns[l].is_sort=u},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{dataIndex:"query_type",title:"查询方式",width:180},{cell:a(({rowIndex:l})=>[e(w,{modelValue:t.value.columns[l].query_type,"onUpdate:modelValue":u=>t.value.columns[l].query_type=u,options:Oe,"allow-clear":""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),e(g,{dataIndex:"view_type",title:"页面控件",width:240},{cell:a(({record:l,rowIndex:u})=>[e(ce,null,{default:a(()=>[e(w,{modelValue:t.value.columns[u].view_type,"onUpdate:modelValue":n=>t.value.columns[u].view_type=n,style:{width:"160px"},options:Ee,"allow-clear":""},null,8,["modelValue","onUpdate:modelValue","options"]),le.value.includes(l.view_type)?B("",!0):(c(),q(Y,{key:0,onClick:n=>G.value.open(l)},{default:a(()=>[d("设置")]),_:2},1032,["onClick"]))]),_:2},1024)]),_:1}),e(g,{dataIndex:"dict_type",title:"数据字典",width:180},{cell:a(({record:l,rowIndex:u})=>[e(w,{modelValue:t.value.columns[u].dict_type,"onUpdate:modelValue":n=>t.value.columns[u].dict_type=n,options:H.value,"allow-clear":"","field-names":{label:"name",value:"code"},placeholder:"选择数据字典",disabled:!["select","radio","checkbox","transfer"].includes(l.view_type)},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),_:1}),e(g,{dataIndex:"allow_roles",title:"允许角色",width:200},{cell:a(({record:l,rowIndex:u})=>[e(w,{modelValue:t.value.columns[u].allow_roles,"onUpdate:modelValue":n=>t.value.columns[u].allow_roles=n,multiple:"",options:$.value,"max-tag-count":1,"allow-clear":"","field-names":{label:"name",value:"code"},placeholder:"选择允许查看字段的角色"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1})]),_:1},8,["data"])]),_:1}),e(K,{title:"菜单配置",key:"menu_config"},{default:a(()=>[e(R,{title:"提示"},{default:a(()=>[d("未选择的菜单，后端也对应不生成方法。注意：列表按钮菜单是默认的")]),_:1}),e(_e,{direction:"vertical",modelValue:t.value.generate_menus,"onUpdate:modelValue":o[23]||(o[23]=l=>t.value.generate_menus=l),class:"mt-3","default-value":t.value.generate_menus},{default:a(()=>[(c(!0),h(I,null,T(Ne,(l,u)=>(c(),q(k,{value:l.value,key:u},{default:a(()=>[d(v(l.name+"　-　"+l.comment),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","default-value"])]),_:1}),e(K,{title:"关联配置",key:"relation_config"},{default:a(()=>[e(R,{title:"提示"},{default:a(()=>[d("模型关联支持：一对一、一对多、一对多（反向）、多对多。")]),_:1}),e(fe,{onClick:ne,type:"primary",class:"mt-3"},{default:a(()=>[e(pe),d(" 新增关联")]),_:1}),(c(!0),h(I,null,T(f.value.relations,(l,u)=>(c(),h("div",{key:u},[e(x,{orientation:"left"},{default:a(()=>[d(v(l.name?l.name:"定义新关联")+" ",1),e(Y,{onClick:n=>de(u),class:"ml-5"},{default:a(()=>[e(ve),d(" 删除定义")]),_:2},1032,["onClick"])]),_:2},1024),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"关联类型",field:"type","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"指定关联类型"},{default:a(()=>[e(w,{modelValue:l.type,"onUpdate:modelValue":n=>l.type=n,"allow-clear":"","allow-search":"",placeholder:"请选择关联类型"},{default:a(()=>[(c(!0),h(I,null,T(Ke,n=>(c(),q(C,{key:n.value,value:n.value,label:n.name},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"关联名称",field:"name","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"设置关联名称，且是代码中调用的名称"},{default:a(()=>[e(b,{modelValue:l.name,"onUpdate:modelValue":n=>l.name=n,"allow-clear":"",placeholder:"设置关联名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(r,{gutter:24},{default:a(()=>[e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"关联模型",field:"model","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"选择要关联的模型"},{default:a(()=>[e(w,{modelValue:l.model,"onUpdate:modelValue":n=>l.model=n,"allow-clear":"","allow-search":"",placeholder:"请选择关联模型，可输入关键字过滤"},{default:a(()=>[(c(!0),h(I,null,T(Q.value,n=>(c(),q(C,{key:n,value:n,label:n},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"关联键",field:"localKey","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"关联键，是指本表的外键"},{default:a(()=>[e(w,{style:{width:"100%"},modelValue:l.localKey,"onUpdate:modelValue":n=>l.localKey=n,"allow-clear":"","allow-search":"",placeholder:"请选择关联键，可输入关键字过滤"},{default:a(()=>[(c(!0),h(I,null,T(t.value.columns,(n,we)=>(c(),q(C,{class:"w-full",label:n.column_name+" - "+n.column_comment,value:n.column_name,key:we},{default:a(()=>[p("div",$e,[p("span",null,v(n.column_name),1),p("span",null,v(n.column_comment),1)])]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(r,{gutter:24},{default:a(()=>[he(e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:"中间表名称",field:"model","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"多对多的中间表，一般直接指定表的名称"},{default:a(()=>[e(w,{style:{width:"100%"},modelValue:l.table,"onUpdate:modelValue":n=>l.table=n,"allow-clear":"","allow-search":"",placeholder:"请选择中间表，可输入关键字过滤"},{default:a(()=>[(c(!0),h(I,null,T(W.value,n=>(c(),q(C,{class:"w-full",key:n.name,label:n.name+" - "+n.comment,value:n.name},{default:a(()=>[p("div",He,[p("span",null,v(n.name),1),p("span",null,v(n.comment),1)])]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1536),[[Ue,l.type==="belongsToMany"]]),e(i,{xs:24,md:12,xl:12},{default:a(()=>[e(m,{label:l.type==="belongsToMany"?"中间表外键":"外键",field:"foreignKey","label-col-flex":"auto","label-col-style":{width:"100px"},extra:"关联表外键或中间表的外键"},{default:a(()=>[e(b,{style:{width:"100%"},modelValue:l.foreignKey,"onUpdate:modelValue":n=>l.foreignKey=n,"allow-clear":"",placeholder:l.type==="belongsToMany"?"中间表外键名称":"关联表外键名称"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),_:1},8,["active-key"])]),_:1},8,["model"])]),_:1},8,["loading"]),e(Me,{ref_key:"settingComponentRef",ref:G,onConfrim:oe},null,512)]),_:1},8,["visible"])}}}),tl=ge(We,[["__scopeId","data-v-c4036efc"]]);export{tl as default};
