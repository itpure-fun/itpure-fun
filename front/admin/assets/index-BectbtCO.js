import{a as t,_ as A}from"./bind-BGlh7AZq.js";import{k as u,a7 as C,S as m,fA as f,r as p,o as D,c as R,d as n,J as T,e as P,w as r,f as _,M as S}from"./index-CeUf7hzR.js";import"./apiGroup-BsRV2lLw.js";const L={class:"ma-content-block lg:flex justify-between p-4"},E={name:"system:app"},B=Object.assign(E,{setup(V){const s=u(),c=u(),h=e=>{window.open(window.location.origin+"/#/mineDoc?app_id="+e.app_id+"&app_secret="+e.app_secret)},y=e=>{c.value.open(e)},g=async(e,o)=>{const a=await t.changeStatus({id:o,status:e});a.success&&S.success(a.message)};let x=C(()=>s.value?s.value.isRecovery:!1);const w=m({api:t.getList,recycleApi:t.getRecycleList,showIndex:!1,pageLayout:"fixed",rowSelection:{showCheckedAll:!0},operationColumn:!0,operationColumnWidth:270,add:{show:!0,api:t.save,auth:["system:app:save"]},edit:{show:!0,api:t.update,auth:["system:app:update"]},delete:{show:!0,api:t.deletes,auth:["system:app:delete"],realApi:t.realDeletes,realAuth:["system:app:realDeletes"]},recovery:{show:!0,api:t.recoverys,auth:["system:app:recovery"]},formOption:{width:"850px",layout:[{formType:"grid",cols:[{span:12,formList:[{dataIndex:"group_id"}]},{span:12,formList:[{dataIndex:"app_name"}]}]},{formType:"grid",cols:[{span:18,formList:[{dataIndex:"app_id"}]},{span:5,offset:1,formList:[{dataIndex:"app_id_button"}]}]},{formType:"grid",cols:[{span:18,formList:[{dataIndex:"app_secret"}]},{span:5,offset:1,formList:[{dataIndex:"app_secret_button"}]}]}]}}),k=m([{title:"ID",dataIndex:"id",addDisplay:!1,editDisplay:!1,width:50,hide:!0},{title:"所属组",dataIndex:"group_id",search:!0,commonRules:[{required:!0,message:"所属组必选"}],formType:"select",dict:{url:"system/appGroup/list",props:{label:"name",value:"id"},translation:!0},labelWidth:"140px",width:140},{title:"应用名称",dataIndex:"app_name",search:!0,commonRules:[{required:!0,message:"应用名称必填"}],labelWidth:"120px",width:150},{title:"APP ID",dataIndex:"app_id",search:!0,commonRules:[{required:!0,message:"APP ID必填"}],labelWidth:"120px",disabled:!0,width:120,addDefaultValue:async()=>(await t.getAppId()).data.app_id},{formType:"button",dataIndex:"app_id_button",hide:!0,type:"primary",title:"刷新APP ID",long:!0,onClick:async()=>{const e=s.value.getFormData();if(s.value.getCurrentAction()==="edit"){f.info({simple:!1,hideCancel:!1,title:"提示",content:"此操作会造成已使用的应用验证失败，确定执行吗？",onOk:async()=>{const a=await t.getAppId();e.app_id=a.data.app_id}});return}const o=await t.getAppId();e.app_id=o.data.app_id}},{title:"APP SECRET",dataIndex:"app_secret",commonRules:[{required:!0,message:"APP SECRET必填"}],labelWidth:"120px",disabled:!0,span:19,width:500,addDefaultValue:async()=>(await t.getAppSecret()).data.app_secret},{formType:"button",type:"primary",title:"刷新APP SECRET",long:!0,dataIndex:"app_secret_button",hide:!0,onClick:async()=>{const e=s.value.getFormData();if(s.value.getCurrentAction()==="edit"){f.info({simple:!1,hideCancel:!1,title:"提示",content:"此操作会造成已使用的应用验证失败，确定执行吗？",onOk:async()=>{const a=await t.getAppSecret();e.app_secret=a.data.app_secret}});return}const o=await t.getAppSecret();e.app_secret=o.data.app_secret}},{title:"状态",dataIndex:"status",search:!0,formType:"radio",dict:{name:"data_status",props:{label:"title",value:"key"}},addDefaultValue:"1",width:80},{title:"应用介绍",dataIndex:"description",hide:!0,formType:"editor"},{title:"备注",dataIndex:"remark",hide:!0,formType:"textarea"},{title:"创建时间",dataIndex:"created_at",addDisplay:!1,editDisplay:!1,width:180}]);return(e,o)=>{const a=p("a-switch"),I=p("icon-book"),l=p("a-link"),v=p("icon-pushpin"),b=p("ma-crud");return D(),R("div",L,[n(b,{options:w,columns:k,ref_key:"crudRef",ref:s},T({status:r(({record:i})=>[n(a,{"checked-value":1,"unchecked-value":"2",onChange:d=>g(d,i.id),"default-checked":i.status==1},null,8,["onChange","default-checked"])]),_:2},[P(x)?void 0:{name:"operationBeforeExtend",fn:r(({record:i})=>[n(l,{onClick:d=>h(i)},{default:r(()=>[n(I),_(" 文档")]),_:2},1032,["onClick"]),n(l,{onClick:d=>y(i.id)},{default:r(()=>[n(v),_(" 绑定")]),_:2},1032,["onClick"])]),key:"0"}]),1032,["options","columns"]),n(A,{ref_key:"bindRef",ref:c},null,512)])}}});export{B as default};
