import{r as s}from"./role-VtW8cE0Z.js";import T from"./menuPermission-DU87hK2I.js";import B from"./dataPermission-DbpXeXnZ.js";import{k as d,a7 as E,S as _,M as u,r,o as m,c as y,d as o,w as i,i as k,e as M,h as N,f as v}from"./index-CeUf7hzR.js";import"./menu-C2llVahg.js";import"./dept-B-4ODiIu.js";const P={class:"ma-content-block lg:flex justify-between p-4"},O={key:0},j={name:"system:role"},J=Object.assign(j,{setup(q){const l=d(),p=d(),f=d();let g=E(()=>l.value?l.value.isRecovery:!1);const w=e=>{p.value.open(e)},x=e=>{f.value.open(e)},C=async(e,a)=>{if(a.code==="superAdmin"){u.info("超级管理员角色不能禁用");return}const n=await s.changeStatus({id:a.id,status:e});n.success&&u.success(n.message)},b=async(e,a)=>{if(a===1){u.info("超级管理员不能修改");return}const n=await s.numberOperation({id:a,numberName:"sort",numberValue:e});n.success&&u.success(n.message)},D=_({api:s.getPageList,recycleApi:s.getRecyclePageList,showIndex:!1,pageLayout:"fixed",rowSelection:{showCheckedAll:!0},operationColumn:!0,operationColumnWidth:300,add:{show:!0,api:s.save,auth:["system:role:save"]},edit:{show:!0,api:s.update,auth:["system:role:update"]},delete:{show:!0,api:s.deletes,auth:["system:role:delete"],realApi:s.realDeletes,realAuth:["system:role:realDeletes"]},recovery:{show:!0,api:s.recoverys,auth:["system:role:recovery"]},isDbClickEdit:!1,beforeOpenEdit:e=>e.id===1?(u.error("超级管理员角色不可编辑"),!1):!0,beforeDelete:e=>e.includes(1)?(u.error("超级管理员角色不可删除"),!1):!0}),R=_([{title:"ID",dataIndex:"id",addDisplay:!1,editDisplay:!1,width:50,hide:!0},{title:"角色名称",dataIndex:"name",search:!0,commonRules:[{required:!0,message:"角色名称必填"}],width:220},{title:"角色标识",dataIndex:"code",search:!0,commonRules:[{required:!0,message:"角色标识必填"}],width:180},{title:"排序",dataIndex:"sort",formType:"input-number",addDefaultValue:1,width:180,min:0,max:1e3},{title:"状态",dataIndex:"status",search:!0,formType:"radio",dict:{name:"data_status",props:{label:"title",value:"key"}},addDefaultValue:"1",width:100},{title:"备注",dataIndex:"remark",hide:!0,formType:"textarea"},{title:"创建时间",dataIndex:"created_at",addDisplay:!1,editDisplay:!1,width:200,search:!0,formType:"range"}]);return(e,a)=>{const n=r("a-input-number"),I=r("a-switch"),S=r("icon-menu"),h=r("a-link"),A=r("icon-layers"),V=r("a-space"),L=r("ma-crud");return m(),y("div",P,[o(L,{options:D,columns:R,ref_key:"crudRef",ref:l},{sort:i(({record:t})=>[o(n,{"default-value":t.sort,mode:"button",onChange:c=>b(c,t.id),min:0,max:1e3},null,8,["default-value","onChange"])]),status:i(({record:t})=>[o(I,{"checked-value":1,"unchecked-value":"2",onChange:c=>C(c,t),"default-checked":t.status==1},null,8,["onChange","default-checked"])]),operationCell:i(({record:t})=>[t.code==="superAdmin"?(m(),y("div",O)):k("",!0)]),operationBeforeExtend:i(({record:t})=>[t.code!=="superAdmin"&&!M(g)?(m(),N(V,{key:0,size:"mini"},{default:i(()=>[o(h,{onClick:c=>w(t)},{default:i(()=>[o(S),v(" 菜单权限")]),_:2},1032,["onClick"]),o(h,{onClick:c=>x(t)},{default:i(()=>[o(A),v(" 数据权限")]),_:2},1032,["onClick"])]),_:2},1024)):k("",!0)]),_:1},8,["options","columns"]),o(T,{ref_key:"mpRef",ref:p,onSuccess:a[0]||(a[0]=()=>l.value.refresh())},null,512),o(B,{ref_key:"dpRef",ref:f,onSuccess:a[1]||(a[1]=()=>l.value.refresh())},null,512)])}}});export{J as default};
