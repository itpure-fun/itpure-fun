import{_ as M,n as N,S as w,k as B,A as S,q as V,x as T,M as q,r as l,o,c as v,l as c,d as a,fE as z,w as t,f as y,t as _,e as p,h as r,F as j,g as O}from"./index-CeUf7hzR.js";import{u as E}from"./user-D2kyxwaZ.js";import F from"./modifyPassword-BlWF3RUn.js";import U from"./userInfomation-CzYYRg3G.js";const D={class:"block"},P={class:"user-header rounded-sm text-center"},A={class:"pt-3 mx-auto avatar-box"},G={class:"ma-content-block w-full lg:w-6/12 mt-3 p-4"},H={class:"ma-content-block w-full lg:w-6/12 mt-3 p-4 ml-0 lg:ml-3"},J={name:"userCenter"},K=Object.assign(J,{setup(Q){var b;const s=N(),u=w({...s.user}),i=B([]),d=B([]),k=w({pageSize:5});return S(()=>{V.getLoginLogList(Object.assign(k,{orderBy:"login_time",orderType:"desc"})).then(n=>{i.value=n.data.items}),V.getOperationLogList(Object.assign(k,{orderBy:"created_at",orderType:"desc"})).then(n=>{d.value=n.data.items})}),u.avatar=((b=s==null?void 0:s.user)==null?void 0:b.avatar)??void 0,T(()=>u.avatar,async n=>{n&&(await E.updateInfo({avatar:n})).success&&(q.success("头像修改成功"),s.user.avatar=n)}),(n,f)=>{const C=l("a-tag"),m=l("a-tab-pane"),h=l("a-tabs"),x=l("a-timeline-item"),L=l("a-timeline"),$=l("a-empty"),I=l("a-layout-content");return o(),v("div",D,[c("div",P,[c("div",A,[a(z,{modelValue:u.avatar,"onUpdate:modelValue":f[0]||(f[0]=e=>u.avatar=e),rounded:""},null,8,["modelValue"])]),c("div",null,[a(C,{size:"large",class:"mt-3 rounded-full",color:"#165dff"},{default:t(()=>[y(_(p(s).user&&p(s).user.nickname||p(s).user&&p(s).user.username),1)]),_:1})])]),a(I,{class:"block lg:flex lg:justify-between"},{default:t(()=>[c("div",G,[a(h,{type:"rounded"},{default:t(()=>[a(m,{key:"info",title:"个人资料"},{default:t(()=>[a(U)]),_:1}),a(m,{key:"safe",title:"安全设置"},{default:t(()=>[a(F)]),_:1})]),_:1})]),c("div",H,[a(h,{type:"rounded"},{default:t(()=>[a(m,{key:"login-log",title:"登录日志"},{default:t(()=>[i.value&&i.value.length?(o(),r(L,{key:0,class:"pl-5 mt-3"},{default:t(()=>[(o(!0),v(j,null,O(i.value,(e,g)=>(o(),r(x,{label:`地理位置；${e.ip_location}，操作系统：${e.os}`,key:g},{default:t(()=>[y(" 您于 "+_(e.login_time)+" 登录系统，"+_(e.message),1)]),_:2},1032,["label"]))),128))]),_:1})):(o(),r($,{key:1}))]),_:1}),a(m,{key:"operation-log",title:"操作日志"},{default:t(()=>[d.value&&d.value.length?(o(),r(L,{key:0,class:"pl-5 mt-3"},{default:t(()=>[(o(!0),v(j,null,O(d.value,(e,g)=>(o(),r(x,{label:`地理位置；${e.ip_location}，方式：${e.method}，路由：${e.router}`,key:g},{default:t(()=>[y(" 您于 "+_(e.created_at)+" 执行了 "+_(e.service_name),1)]),_:2},1032,["label"]))),128))]),_:1})):(o(),r($,{key:1}))]),_:1})]),_:1})])]),_:1})])}}}),Z=M(K,[["__scopeId","data-v-e2f106bd"]]);export{Z as default};
